$objectArr = @()
$IPS = (
"100.100.4.0",
"104.129.192.32",
"104.129.194.32",
"104.129.196.32",
"104.129.198.32",
"104.129.200.32",
"104.129.204.32",
"115.113.118.199",
"115.113.118.225",
"115.114.8.250",
"115.114.8.252",
"12.71.226.254",
"121.134.74.111",
"124.238.221.240",
"125.19.135.112",
"129.39.149.0",
"129.39.150.0",
"134.37.38.0",
"14.141.2.75",
"141.73.153.1",
"141.73.153.7",
"141.73.153.8",
"144.36.190.0",
"144.36.251.227",
"144.36.26.241",
"146.170.125.126",
"146.170.125.64",
"146.170.67.126",
"146.170.67.64",
"146.188.102.135",
"146.188.96.8",
"146.188.99.69",
"147.225.0.12",
"147.225.108.28",
"147.225.108.64",
"147.225.111.140",
"147.225.12.44",
"147.225.12.45",
"147.225.133.68",
"147.225.135.196",
"147.225.140.124",
"147.225.152.100",
"147.225.156.84",
"147.225.17.144",
"147.225.171.228",
"147.225.174.92",
"147.225.177.28",
"147.225.193.172",
"147.225.197.192",
"147.225.22.208",
"147.225.229.100",
"147.225.231.132",
"147.225.232.0",
"147.225.27.180",
"147.225.28.176",
"147.225.4.76",
"147.225.45.160",
"147.225.51.48",
"147.225.53.224",
"147.225.57.96",
"147.225.59.132",
"147.225.65.188",
"147.225.65.28",
"147.225.71.88",
"147.225.84.88",
"147.225.85.60",
"147.225.88.108",
"147.225.89.232",
"147.225.94.136",
"150.105.60.254",
"150.105.62.15",
"152.161.120.236",
"152.161.137.184",
"152.161.168.184",
"152.161.201.144",
"152.161.232.56",
"152.161.236.212",
"152.161.246.56",
"152.161.32.228",
"152.161.57.116",
"152.161.60.16",
"152.161.68.156",
"152.161.7.64",
"152.161.70.52",
"152.161.99.48",
"152.162.1.140",
"152.162.10.88",
"152.162.108.148",
"152.162.113.200",
"152.162.12.160",
"152.162.128.220",
"152.162.130.64",
"152.162.134.28",
"152.162.140.80",
"152.162.152.64",
"152.162.170.248",
"152.162.179.80",
"152.162.181.56",
"152.162.182.68",
"152.162.187.160",
"152.162.206.220",
"152.162.210.96",
"152.162.227.196",
"152.162.231.132",
"152.162.250.172",
"152.162.254.160",
"152.162.35.120",
"152.162.57.104",
"152.162.59.72",
"152.162.6.192",
"152.162.72.168",
"152.162.77.112",
"152.162.79.144",
"152.162.97.36",
"152.162.99.40",
"152.164.125.136",
"152.164.136.48",
"152.164.137.128",
"152.164.141.252",
"152.164.142.208",
"152.164.149.100",
"152.164.149.72",
"152.164.15.88",
"152.164.159.80",
"152.164.164.108",
"152.164.18.188",
"152.164.182.248",
"152.164.189.192",
"152.164.202.244",
"152.164.206.32",
"152.164.211.68",
"152.164.231.148",
"152.164.246.120",
"152.164.246.36",
"152.164.25.28",
"152.164.28.156",
"152.164.29.24",
"152.164.50.92",
"152.164.52.88",
"152.164.62.168",
"152.164.63.248",
"152.164.69.16",
"152.164.75.216",
"152.164.75.72",
"152.164.79.144",
"152.176.127.208",
"152.176.13.240",
"152.176.141.68",
"152.176.161.164",
"152.176.196.192",
"152.176.2.116",
"152.176.229.32",
"152.176.50.168",
"152.176.59.24",
"152.176.71.92",
"152.176.81.156",
"152.177.0.164",
"152.177.103.12",
"152.177.12.128",
"152.177.138.108",
"152.177.144.12",
"152.177.164.244",
"152.177.167.116",
"152.177.17.44",
"152.177.177.32",
"152.177.18.164",
"152.177.180.172",
"152.177.184.116",
"152.177.188.212",
"152.177.19.12",
"152.177.204.44",
"152.177.205.80",
"152.177.206.240",
"152.177.247.232",
"152.177.56.20",
"152.177.6.68",
"152.177.60.172",
"152.177.60.176",
"152.177.69.104",
"152.177.77.48",
"152.177.91.236",
"152.181.104.200",
"152.181.108.232",
"152.181.117.252",
"152.181.118.32",
"152.181.145.88",
"152.181.147.168",
"152.181.152.0",
"152.181.166.168",
"152.181.18.56",
"152.181.180.156",
"152.181.182.68",
"152.181.188.48",
"152.181.193.236",
"152.181.233.236",
"152.181.238.104",
"152.181.255.224",
"152.181.50.236",
"152.181.87.76",
"152.183.101.88",
"152.183.109.172",
"152.183.140.112",
"152.183.141.192",
"152.183.159.164",
"152.183.20.236",
"152.183.23.156",
"152.183.240.240",
"152.183.242.248",
"152.183.33.8",
"152.183.37.176",
"152.183.40.88",
"152.183.56.244",
"152.183.63.16",
"152.183.71.68",
"152.183.83.32",
"152.183.96.108",
"152.185.16.244",
"152.185.169.168",
"152.185.191.244",
"152.185.192.180",
"152.185.198.176",
"152.185.244.196",
"152.185.246.44",
"152.185.248.4",
"152.185.249.224",
"152.185.250.152",
"152.185.26.8",
"152.185.44.160",
"152.185.47.240",
"152.185.61.160",
"152.187.100.92",
"152.187.123.228",
"152.187.141.0",
"152.187.145.100",
"152.187.161.128",
"152.187.183.208",
"152.187.42.96",
"152.192.102.192",
"152.192.123.204",
"152.192.133.96",
"152.192.18.28",
"152.192.35.92",
"152.192.58.32",
"152.192.9.140",
"153.2.72.40",
"153.39.10.21",
"153.39.16.241",
"155.195.0.0",
"156.34.97.126",
"157.45.1.138",
"157.45.1.94",
"157.47.0.0",
"158.43.128.170",
"158.98.129.0",
"158.98.187.0",
"158.98.71.128",
"159.24.154.0",
"159.24.174.116",
"159.24.175.52",
"159.24.182.84",
"159.24.213.8",
"159.24.235.204",
"159.24.238.244",
"159.24.244.156",
"159.24.251.184",
"159.7.82.0",
"160.1.1.0",
"160.254.39.232",
"160.254.59.232",
"160.254.76.0",
"160.46.140.46",
"160.46.193.195",
"160.48.0.0",
"160.52.0.0",
"164.9.148.250",
"165.182.208.65",
"165.225.32.32",
"165.225.34.32",
"165.225.36.32",
"165.225.64.32",
"165.225.68.32",
"165.225.72.32",
"165.225.76.32",
"165.225.80.32",
"165.251.36.0",
"165.251.36.69",
"165.72.234.152",
"167.210.249.178",
"167.210.249.182",
"169.154.0.0",
"170.227.195.64",
"173.15.2.129",
"173.15.2.131",
"175.176.202.205",
"185.4.4.0",
"185.4.5.0",
"185.46.212.32",
"185.46.214.32",
"189.52.221.88",
"189.80.45.33",
"189.80.45.35",
"190.216.186.60",
"192.165.116.0",
"192.64.29.0",
"193.162.146.71",
"193.163.24.224",
"193.163.28.244",
"193.180.205.5",
"193.183.156.4",
"193.28.100.40",
"193.28.103.100",
"193.28.103.247",
"193.28.103.29",
"193.28.103.63",
"193.28.99.169",
"193.28.99.170",
"193.28.99.171",
"193.28.99.172",
"193.30.113.97",
"193.44.78.76",
"193.44.78.77",
"193.46.254.0",
"193.99.41.23",
"194.103.130.0",
"194.103.130.10",
"194.103.130.11",
"194.103.130.28",
"194.103.131.0",
"194.117.106.128",
"194.14.201.51",
"194.150.30.224",
"194.175.186.9",
"194.179.50.248",
"194.18.165.200",
"194.183.123.184",
"194.183.123.188",
"194.19.101.91",
"194.19.101.92",
"194.202.137.242",
"194.202.137.244",
"194.202.137.250",
"194.202.137.254",
"194.237.208.12",
"194.39.131.41",
"194.45.200.254",
"195.10.132.192",
"195.10.132.230",
"195.10.191.212",
"195.10.191.48",
"195.124.178.176",
"195.124.178.184",
"195.178.163.27",
"195.198.87.160",
"195.198.87.180",
"195.202.115.0",
"195.202.116.0",
"195.202.118.0",
"195.21.28.0",
"195.238.244.2",
"195.248.35.99",
"195.41.248.160",
"195.41.248.168",
"195.70.164.100",
"195.70.164.64",
"195.81.79.92",
"195.94.102.0",
"196.13.228.0",
"196.14.156.84",
"196.15.186.232",
"196.20.19.160",
"196.20.3.131",
"196.20.3.132",
"196.20.3.135",
"196.20.4.35",
"196.20.4.37",
"196.30.113.96",
"196.30.51.96",
"196.32.11.16",
"196.32.11.20",
"196.32.8.102",
"196.32.8.104",
"196.32.8.110",
"196.32.8.72",
"196.38.122.208",
"196.38.122.210",
"196.38.122.215",
"196.41.160.0",
"196.41.160.10",
"196.41.160.16",
"196.41.160.169",
"196.41.160.17",
"196.41.160.20",
"196.41.160.21",
"196.41.160.23",
"196.41.160.230",
"196.41.160.26",
"196.41.160.27",
"196.44.0.111",
"197.231.167.180",
"197.231.167.196",
"197.231.167.232",
"198.176.171.7",
"198.178.131.1",
"198.23.14.1",
"199.168.151.129",
"199.219.4.0",
"199.220.109.148",
"199.220.115.108",
"199.220.123.12",
"199.220.137.120",
"199.220.14.232",
"199.220.146.108",
"199.220.149.156",
"199.220.15.136",
"199.220.164.212",
"199.220.171.64",
"199.220.174.248",
"199.220.179.32",
"199.220.189.124",
"199.220.189.125",
"199.220.216.240",
"199.220.217.108",
"199.220.217.96",
"199.220.219.252",
"199.220.22.156",
"199.220.223.100",
"199.220.224.64",
"199.220.227.176",
"199.220.249.100",
"199.220.29.124",
"199.220.3.64",
"199.220.31.52",
"199.220.35.240",
"199.220.40.216",
"199.220.54.180",
"199.220.68.224",
"199.220.73.228",
"199.220.91.4",
"200.100.100.0",
"200.126.49.31",
"200.143.23.110",
"200.165.60.135",
"200.166.92.53",
"200.181.116.28",
"200.182.30.2",
"200.185.17.16",
"200.187.29.22",
"200.189.113.223",
"200.189.124.60",
"200.233.3.101",
"200.238.83.69",
"200.241.4.185",
"200.251.8.136",
"201.16.232.195",
"201.16.234.52",
"201.174.17.206",
"201.28.66.217",
"201.28.66.218",
"201.55.62.48",
"202.131.248.203",
"202.60.60.22",
"202.94.103.64",
"202.95.108.52",
"202.95.71.100",
"202.95.71.105",
"202.95.71.106",
"202.95.71.98",
"203.166.123.32",
"203.166.123.34",
"203.166.55.250",
"203.193.115.250",
"203.193.115.252",
"203.193.115.254",
"203.193.119.148",
"203.193.119.156",
"204.90.181.87",
"206.114.72.204",
"206.114.76.4",
"206.114.76.40",
"206.114.76.72",
"206.114.78.88",
"206.114.79.196",
"206.114.82.160",
"206.114.95.8",
"206.115.103.120",
"206.115.106.32",
"206.115.12.60",
"206.115.127.216",
"206.115.127.217",
"206.115.14.216",
"206.115.16.152",
"206.115.16.208",
"206.115.3.152",
"206.115.42.56",
"206.115.5.92",
"206.115.52.60",
"206.115.72.224",
"206.115.73.176",
"206.115.87.120",
"206.115.87.20",
"206.115.9.64",
"206.195.19.29",
"206.195.31.0",
"207.236.139.29",
"208.198.3.247",
"208.198.6.244",
"208.198.6.248",
"208.198.6.250",
"208.198.6.254",
"208.205.41.250",
"208.219.129.212",
"208.219.130.4",
"208.219.130.40",
"208.219.130.5",
"208.219.142.232",
"208.219.152.88",
"208.219.158.16",
"208.220.194.56",
"208.220.214.128",
"208.220.215.140",
"208.220.217.92",
"208.220.218.220",
"208.93.112.64",
"209.195.157.30",
"210.80.111.80",
"210.80.126.3",
"210.81.66.22",
"212.153.116.160",
"212.214.50.156",
"212.214.53.8",
"212.214.7.135",
"212.222.224.0",
"212.222.224.0",
"212.222.225.0",
"212.23.61.224",
"213.11.81.34",
"213.131.136.64",
"213.138.129.0",
"213.138.147.192",
"213.150.2.49",
"213.150.2.79",
"213.173.139.146",
"213.225.90.0",
"213.39.67.88",
"213.50.16.156",
"213.50.20.24",
"213.68.123.11",
"213.68.239.234",
"213.68.239.240",
"213.68.239.242",
"213.68.239.246",
"213.68.239.250",
"213.68.239.254",
"213.88.201.150",
"213.88.253.2",
"217.152.71.224",
"217.89.89.56",
"219.101.236.120",
"219.101.236.122",
"219.101.236.123",
"219.101.236.124",
"221.133.216.52",
"221.133.219.15",
"23.120.29.193",
"23.36.219.107",
"3.3.3.3",
"31.15.37.130",
"41.181.135.152",
"41.181.135.232",
"41.181.66.72",
"41.208.12.116",
"41.208.13.108",
"41.208.13.120",
"41.208.6.104",
"41.208.6.108",
"41.208.6.116",
"41.208.6.120",
"41.208.6.136",
"41.208.6.76",
"41.208.6.84",
"41.208.6.88",
"41.208.6.92",
"41.208.6.96",
"46.255.192.20",
"50.207.148.91",
"50.207.148.92",
"60.10.56.192",
"60.10.56.196",
"62.127.208.90",
"62.127.208.91",
"62.168.156.90",
"62.183.215.32",
"62.183.215.48",
"62.186.24.244",
"62.186.26.133",
"62.189.75.181",
"62.189.75.182",
"62.191.142.201",
"62.23.143.0",
"62.236.37.0",
"62.237.108.132",
"62.237.108.188",
"62.237.108.64",
"62.237.109.128",
"62.237.109.144",
"62.237.109.252",
"62.237.110.2",
"62.237.110.4",
"62.237.110.70",
"62.237.111.2",
"62.237.171.98",
"62.237.177.104",
"62.237.44.11",
"62.8.237.138",
"62.95.21.20",
"62.95.82.200",
"64.117.208.96",
"64.18.22.0",
"64.18.25.160",
"64.18.26.150",
"64.18.26.73",
"64.215.22.32",
"65.249.101.128",
"65.249.105.176",
"65.249.108.188",
"65.249.121.120",
"65.250.26.52",
"65.250.30.172",
"65.250.30.173",
"65.250.30.44",
"66.168.32.216",
"67.128.146.128",
"67.38.207.192",
"68.115.211.132",
"68.136.103.232",
"68.136.120.8",
"68.136.133.164",
"68.136.136.108",
"68.136.137.224",
"68.136.165.16",
"68.136.169.112",
"68.136.172.8",
"68.136.18.104",
"68.136.208.52",
"68.136.225.128",
"68.136.251.200",
"68.136.35.188",
"68.136.35.48",
"68.136.39.136",
"68.136.42.76",
"68.136.46.132",
"68.136.67.104",
"68.136.70.208",
"68.136.8.112",
"68.136.81.92",
"68.137.105.200",
"68.137.133.108",
"68.137.133.220",
"68.137.136.176",
"68.137.140.48",
"68.137.175.180",
"68.137.182.236",
"68.137.189.28",
"68.137.192.76",
"68.137.200.216",
"68.137.205.36",
"68.137.208.200",
"68.137.217.36",
"68.137.238.168",
"68.137.28.40",
"68.137.28.41",
"68.137.34.180",
"68.137.34.204",
"68.137.34.244",
"68.137.37.208",
"68.137.38.136",
"68.137.43.180",
"68.137.43.200",
"68.137.5.152",
"68.137.55.48",
"68.137.60.92",
"68.137.61.52",
"68.137.65.100",
"68.137.69.220",
"68.137.77.140",
"68.138.1.0",
"68.138.106.20",
"68.138.111.16",
"68.138.120.120",
"68.138.140.24",
"68.138.147.132",
"68.138.15.228",
"68.138.150.216",
"68.138.154.24",
"68.138.154.68",
"68.138.155.216",
"68.138.159.0",
"68.138.172.224",
"68.138.176.220",
"68.138.185.232",
"68.138.189.152",
"68.138.189.44",
"68.138.194.160",
"68.138.221.152",
"68.138.225.88",
"68.138.229.88",
"68.138.232.208",
"68.138.233.124",
"68.138.3.252",
"68.138.30.80",
"68.138.42.28",
"68.138.5.156",
"68.138.68.224",
"68.138.79.64",
"68.138.93.184",
"68.139.101.84",
"68.139.103.100",
"68.139.103.101",
"68.139.110.44",
"68.139.139.96",
"68.139.154.4",
"68.139.167.52",
"68.139.172.28",
"68.139.175.112",
"68.139.197.128",
"68.139.207.80",
"68.139.219.100",
"68.139.219.252",
"68.139.248.176",
"68.139.25.136",
"68.139.253.44",
"68.139.254.28",
"68.139.4.248",
"68.139.48.128",
"68.139.61.160",
"68.139.67.176",
"68.139.71.60",
"68.139.82.12",
"68.139.85.204",
"68.177.7.37",
"69.67.44.8",
"80.252.175.196",
"80.253.215.16",
"80.253.215.64",
"81.175.254.128",
"81.175.254.32",
"81.31.2.204",
"81.31.2.208",
"82.161.73.240",
"82.195.192.8",
"82.195.192.88",
"82.195.200.0",
"82.195.201.0",
"82.195.202.0",
"84.233.209.32",
"85.19.11.48",
"85.19.32.152",
"87.234.227.83",
"87.94.212.0",
"87.94.213.32",
"87.94.217.160",
"87.94.217.208",
"88.131.18.114",
"88.131.18.115",
"88.131.181.80",
"89.167.129.32",
"89.202.116.104",
"89.202.116.18",
"89.202.116.67",
"89.202.116.77",
"89.202.125.42",
"89.236.107.21",
"89.236.107.95",
"95.97.114.212"
)


foreach ($IP in $IPS) {
echo "fetching $IP"
Start-Sleep -Milliseconds 400
$response = Invoke-RestMethod -Method Get -Uri http://ip-api.com/json/$IP

    $prop = [ordered]@{
        'as' = $response.as
        'city' = $response.city
        'country' = $response.country
        'countrycode' = $response.countrycode
        'isp' = $response.isp
        'lat' = $response.lat
        'lon' = $response.lon
        'org' = $response.org
        'query' = $response.query
        'region' = $response.region
        'regionname' = $response.regionname
        'status' = $response.status
        'timezone' = $response.timezone
        'zip' = $response.zip
        }
 $obj = New-Object -Type PSCustomObject -Property $prop
 $objectArr += $obj
 $obj
 }


 $objectArr
 $objectArr | Export-Csv c:\temp\IPs.csv -NoTypeInformation
